{% extends "client/index.html" %} {% block content %}
<section class="main-content">
  <div class="container">
    <div class="messages columns">
      <div class="column is-narrow left pc">
        <ul class="nav-user">
          <li>
            <a class="li01" href="{% url 'info' user.id %}"
              >Quản lý tài khoản</a
            >
          </li>
          <li>
            <a class="li" href="{% url 'dang-ky-truyen' %}">Đăng ký truyện</a>
          </li>
          <li><a class="li02" href="#">Tin nhắn</a></li>
          <li>
            <a class="li03 is-active" href="{% url 'doi-mat-khau' user.id %}"
              >Đổi mật khẩu</a
            >
          </li>
        </ul>
      </div>
      <div class="column">
        {% if errorpassold %}
        <div class="alert alert-warning">Mật khẩu cũ không đúng</div>
        {% endif %} {% if errorcomfirmpass %}
        <div class="alert alert-warning">
          Xác nhận mật khẩu mới không giống nhau!
        </div>
        {% endif %} {% if success %}
        <div class="alert alert-success">
          Bạn đã đổi mật khẩu thành công!
        </div>
        {% endif %}
        <div class="level title">
          <p class="level-left has-text-weight-bold">Đổi mật khẩu</p>
        </div>
        <form method="post">
          {% csrf_token %}
          <div class="form-change-pass">
            <div class="field">
              <p class="txt">Mật khẩu hiện tại</p>
              <p class="control">
                <input
                  class="input"
                  type="password"
                  value=""
                  name="password_old"
                  id="password_old"
                />
              </p>
            </div>
            <div class="field">
              <p class="txt">Mật khẩu mới</p>
              <p class="control">
                <input
                  class="input"
                  type="password"
                  value=""
                  name="password_new"
                  id="password_new"
                />
              </p>
            </div>
            <div class="field">
              <p class="txt">Xác nhận mật khẩu</p>
              <p class="control">
                <input
                  class="input"
                  type="password"
                  value=""
                  name="confirm_password_new"
                  id="confirm_password_new"
                />
              </p>
            </div>
            <div class="field">
              <p class="control">
                <button class="button is-danger" type="submit">
                  Đổi mật khẩu
                </button>
              </p>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
</section>
{% endblock %} {% block js %}
<script type="text/javascript">
  $("#password_old").change(function () {
    var passReg = /^[A-Za-z0-9]+$/;
    var Password = $(this).val();
    if (!passReg.test(Password)) {
      alert("Mật khẩu không chứa ký tự đặc biệt !");
      $(this).val("");
    } else if (Password.trim().length <= 6) {
      alert("Mật khẩu ít nhất 6 ký tự");
      $(this).val("");
    } else if (Password == "") {
      alert("Mật khẩu không được bỏ trống!");
    }
  });
  $("#password_new").change(function () {
    var passReg = /^[A-Za-z0-9]+$/;
    var Password = $(this).val();
    if (!passReg.test(Password)) {
      alert("Mật khẩu không chứa ký tự đặc biệt !");
      $(this).val("");
    } else if (Password.trim().length <= 6) {
      alert("Mật khẩu ít nhất 6 ký tự");
      $(this).val("");
    } else if (Password == "") {
      alert("Mật khẩu không được bỏ trống!");
    }
  });
  $("#confirm_password_new").change(function () {
    var passReg = /^[A-Za-z0-9]+$/;
    var Password = $(this).val();
    if (!passReg.test(Password)) {
      alert("Mật khẩu không chứa ký tự đặc biệt !");
      $(this).val("");
    } else if (Password.trim().length <= 6) {
      alert("Mật khẩu ít nhất 6 ký tự");
      $(this).val("");
    } else if (Password == "") {
      alert("Mật khẩu không được bỏ trống!");
    }
  });
</script>
{% endblock js %}
